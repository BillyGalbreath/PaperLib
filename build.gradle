/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

apply plugin: 'java'
apply plugin: 'maven'

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        name 'papermc'
        url 'https://papermc.io/repo/repository/maven-public/'
    }

}
dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
    compileOnly group: 'com.google.code.findbugs', name: 'jsr305', version: '1.3.9'
    compileOnly group: 'com.destroystokyo.paper', name: 'paper-api', version: '1.13.1-R0.1-SNAPSHOT'
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'

    from sourceSets.main.allSource
}

javadoc {
    failOnError = false
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    from javadoc.destinationDir
    classifier = 'javadoc'
}

artifacts {
    archives javadocJar
    archives sourcesJar
}

task deploy() {
    dependsOn install
    dependsOn uploadArchives
}

if (project.hasProperty('papermcRepoUser') && project.hasProperty('papermcRepoPass')) {
    uploadArchives {
        repositories {
            mavenDeployer {
                repository(url: 'https://papermc.io/repo/repository/maven-releases/') {
                    authentication(userName: papermcRepoUser, password: papermcRepoPass)
                }

                snapshotRepository(url: 'https://papermc.io/repo/repository/maven-snapshots/') {
                    authentication(userName: papermcRepoUser, password: papermcRepoPass)
                }
            }
        }
    }
}

